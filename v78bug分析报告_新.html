<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0.78.0 Bug分析报告</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --text-color: #2d3748;
            --bg-color: #f7fafc;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .meta {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .card-title {
            color: var(--primary-color);
            padding: 0 0 15px 0;
            border-bottom: 3px solid var(--primary-color);
            font-size: 1.6em;
            font-weight: bold;
            margin: 0 0 25px 0;
            position: relative;
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 80px;
            height: 3px;
            background: var(--secondary-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        .stat-box .number {
            font-size: 2.5em;
            font-weight: bold;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-box .label {
            color: #718096;
            margin-top: 10px;
            font-size: 0.95em;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .gantt-container {
            position: relative;
            height: 280px;
            margin: 20px 0;
        }

        .flex-container {
            display: flex;
            gap: 20px;
            align-items: stretch;
        }

        .flex-item {
            flex: 1;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
            letter-spacing: 0.3px;
            border: none;
        }

        thead tr {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        tr:hover {
            background: #f7fafc;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-excellent {
            background: #c6f6d5;
            color: #22543d;
        }

        .badge-good {
            background: #bee3f8;
            color: #2c5282;
        }

        .badge-medium {
            background: #feebc8;
            color: #7c2d12;
        }

        .badge-need-improve {
            background: #fed7d7;
            color: #742a2a;
        }

        .red-text {
            color: #e53e3e;
            font-weight: bold;
        }

        .highlight-name {
            color: #e53e3e;
            font-weight: bold;
        }

        h3 {
            color: #4a5568;
            font-size: 1.2em;
            font-weight: 600;
            margin: 20px 0 15px 0;
            padding-left: 12px;
            border-left: 4px solid var(--primary-color);
        }

        h4 {
            color: #718096;
            font-size: 1.05em;
            font-weight: 600;
            margin: 20px 0 10px 0;
        }

        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .flex-container {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>0.78.0 Bug分析报告</h1>
            <div class="meta">
                <div>版本周期：6.30 ~ 7.28</div>
                <div>生成日期：2025-12-22</div>
            </div>
        </div>

        <!-- Bug总体概况 -->
        <div class="card">
            <div class="card-title">Bug总体概况</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="number">806</div>
                    <div class="label">Bug总数</div>
                </div>
                <div class="stat-box">
                    <div class="number">760</div>
                    <div class="label">已解决Bug数<br><small>(94.29%)</small></div>
                </div>
                <div class="stat-box">
                    <div class="number">2.03天</div>
                    <div class="label">平均修复时长</div>
                </div>
                <div class="stat-box">
                    <div class="number">109</div>
                    <div class="label">重新打开Bug数<br><small>(13.52%)</small></div>
                </div>
                <div class="stat-box">
                    <div class="number">37</div>
                    <div class="label">高优先级Bug<br><small>(4.59%)</small></div>
                </div>
                <div class="stat-box">
                    <div class="number">546</div>
                    <div class="label">节日Bug数<br><small>(67.74%)</small></div>
                </div>
                <div class="stat-box">
                    <div class="number">14</div>
                    <div class="label">需求转Bug数<br><small>(1.74%)</small></div>
                </div>
            </div>
        </div>

        <!-- Bug解决结果分布 -->
        <div class="card">
            <div class="card-title">Bug解决结果分布</div>
            <div class="flex-container">
                <div class="flex-item">
                    <table>
                        <thead>
                            <tr>
                                <th>解决结果</th>
                                <th>数量</th>
                                <th>占比</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>已解决</td>
                                <td>760</td>
                                <td>94.29%</td>
                            </tr>
                            <tr>
                                <td>不能复现</td>
                                <td>18</td>
                                <td>2.23%</td>
                            </tr>
                            <tr>
                                <td>非缺陷</td>
                                <td>17</td>
                                <td>2.11%</td>
                            </tr>
                            <tr>
                                <td>不解决</td>
                                <td>10</td>
                                <td>1.24%</td>
                            </tr>
                            <tr>
                                <td>重复提交</td>
                                <td>1</td>
                                <td>0.12%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="flex-item">
                    <div class="chart-container">
                        <canvas id="resultChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 按处理人分组的Bug统计 -->
        <div class="card">
            <div class="card-title">按处理人分组的Bug统计</div>
            <div class="flex-container">
                <div class="flex-item">
                    <h3 style="text-align: center; margin-bottom: 15px;">处理人Bug量排名（前10）</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>处理人</th>
                                <th>数量</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>莫琪</td><td>117</td></tr>
                            <tr><td>2</td><td>孙明昊</td><td>78</td></tr>
                            <tr><td>3</td><td>林康</td><td>72</td></tr>
                            <tr><td>4</td><td>何超</td><td>71</td></tr>
                            <tr><td>5</td><td>李钢</td><td>54</td></tr>
                            <tr><td>6</td><td>龚亮</td><td>53</td></tr>
                            <tr><td>7</td><td>李嘉睿</td><td>41</td></tr>
                            <tr><td>8</td><td class="highlight-name">徐琮淦</td><td>37</td></tr>
                            <tr><td>9</td><td>王姣</td><td>37</td></tr>
                            <tr><td>10</td><td>刘力珲</td><td>36</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="flex-item">
                    <h3 style="text-align: center; margin-bottom: 15px;">修复效率排名（前10）</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>处理人</th>
                                <th>平均修复时长</th>
                                <th>效率评价</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>张婷</td><td>5.27天</td><td><span class="badge badge-need-improve">需改进</span></td></tr>
                            <tr><td>2</td><td>龚亮</td><td>3.10天</td><td><span class="badge badge-need-improve">需改进</span></td></tr>
                            <tr><td>3</td><td>孙明昊</td><td>3.02天</td><td><span class="badge badge-need-improve">需改进</span></td></tr>
                            <tr><td>4</td><td>林康</td><td>2.60天</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>5</td><td class="highlight-name">徐琮淦</td><td>2.29天</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>6</td><td>谭畅</td><td>2.20天</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>7</td><td>张涵</td><td>1.94天</td><td><span class="badge badge-good">良好</span></td></tr>
                            <tr><td>8</td><td>王姣</td><td>1.83天</td><td><span class="badge badge-good">良好</span></td></tr>
                            <tr><td>9</td><td>王然</td><td>1.70天</td><td><span class="badge badge-good">良好</span></td></tr>
                            <tr><td>10</td><td>方菱葭</td><td>1.61天</td><td><span class="badge badge-good">良好</span></td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="flex-item">
                    <h3 style="text-align: center; margin-bottom: 15px;">重开率排名（前10）</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>处理人</th>
                                <th>Bug重开率</th>
                                <th>解决质量评价</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>田明月</td><td>40.00%</td><td><span class="badge badge-need-improve">需改进</span></td></tr>
                            <tr><td>2</td><td>谭畅</td><td>25.00%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>3</td><td class="highlight-name">徐琮淦</td><td>24.32%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>4</td><td>方菱葭</td><td>22.22%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>5</td><td>张婷</td><td>21.43%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>6</td><td>李钢</td><td>20.37%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>7</td><td>王子琛</td><td>20.00%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>8</td><td>刘思毅</td><td>20.00%</td><td><span class="badge badge-medium">中等</span></td></tr>
                            <tr><td>9</td><td>何超</td><td>18.31%</td><td><span class="badge badge-good">良好</span></td></tr>
                            <tr><td>10</td><td>王然</td><td>16.67%</td><td><span class="badge badge-good">良好</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 15px;">处理人四象限分析（Bug数量 vs 重开率）</h3>
                <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 15px; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #ef4444; border: 2px solid #dc2626;"></div>
                        <span style="font-size: 0.9em; color: #718096;">高Bug数量 + 高重开率（需重点关注）</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #eab308; border: 2px solid #ca8a04;"></div>
                        <span style="font-size: 0.9em; color: #718096;">高Bug数量 + 低重开率（工作量大质量好）</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #22c55e; border: 2px solid #16a34a;"></div>
                        <span style="font-size: 0.9em; color: #718096;">低Bug数量 + 低重开率（表现优秀）</span>
                    </div>
                </div>
                <div class="chart-container" style="height: 500px;">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>
            <div style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 15px;">处理人四象限分析（修复效率 vs 重开率）</h3>
                <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 15px; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #ef4444; border: 2px solid #dc2626;"></div>
                        <span style="font-size: 0.9em; color: #718096;">慢修复 + 高重开率（最需改进）</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #eab308; border: 2px solid #ca8a04;"></div>
                        <span style="font-size: 0.9em; color: #718096;">慢修复 + 低重开率（效率需改进）</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: #22c55e; border: 2px solid #16a34a;"></div>
                        <span style="font-size: 0.9em; color: #718096;">快修复 + 低重开率（表现最优）</span>
                    </div>
                </div>
                <div class="chart-container" style="height: 500px;">
                    <canvas id="efficiencyScatterChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 高优先级Bug分析 -->
        <div class="card">
            <div class="card-title">高优先级Bug分析</div>
            <table>
                <thead>
                    <tr>
                        <th>排名</th>
                        <th>任务处理人</th>
                        <th>数量</th>
                        <th>对应功能</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>徐琮淦</td>
                        <td>6</td>
                        <td>巅峰战场优化(6)</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>孙明昊</td>
                        <td>6</td>
                        <td>8月节日-bp分阶段(5), 8月节日-行军特效礼包(1)</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>刘力珲</td>
                        <td>5</td>
                        <td>8月节日-bp分阶段(4), 8月节日-庆典抽奖(1)</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>何超</td>
                        <td>4</td>
                        <td>8月节日-行军皮肤套装(2), 适配平台SDK剔除关键字(1), 线上问题(1)</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>张涵</td>
                        <td>3</td>
                        <td>8月节日-装饰许愿(3)</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>李嘉睿</td>
                        <td>2</td>
                        <td>8月节日-装饰许愿(2)</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>刘德江</td>
                        <td>2</td>
                        <td>巅峰战场优化(2)</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>林康</td>
                        <td>2</td>
                        <td>8月节日-主体gacha(2)</td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>牟科</td>
                        <td>1</td>
                        <td>巅峰战场优化(1)</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>张婷</td>
                        <td>1</td>
                        <td>8月节日-单笔充值(1)</td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>李钢</td>
                        <td>1</td>
                        <td>8月节日-单笔充值(1)</td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td>谭畅</td>
                        <td>1</td>
                        <td>巅峰战场优化(1)</td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td>龚亮</td>
                        <td>1</td>
                        <td>8月节日-挖矿累计(1)</td>
                    </tr>
                    <tr>
                        <td>14</td>
                        <td>莫琪</td>
                        <td>1</td>
                        <td>金刚机甲皮肤(1)</td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td>张治春</td>
                        <td>1</td>
                        <td>新跨服战场优化(1)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 功能Bug分布 -->
        <div class="card">
            <div class="card-title">功能Bug分布（前20）</div>
            <table>
                <thead>
                    <tr>
                        <th>功能名称</th>
                        <th>Bug数量</th>
                        <th>高优先级数量</th>
                        <th>高优先级占比</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>8月节日-主体gacha</td>
                        <td>96</td>
                        <td class="red-text">2</td>
                        <td class="red-text">2.08%</td>
                    </tr>
                    <tr>
                        <td>新跨服战场优化</td>
                        <td>84</td>
                        <td class="red-text">1</td>
                        <td class="red-text">1.19%</td>
                    </tr>
                    <tr>
                        <td>巅峰战场优化</td>
                        <td>76</td>
                        <td class="red-text">10</td>
                        <td class="red-text">13.16%</td>
                    </tr>
                    <tr>
                        <td>8月节日-装饰许愿</td>
                        <td>75</td>
                        <td class="red-text">5</td>
                        <td class="red-text">6.67%</td>
                    </tr>
                    <tr>
                        <td>8月节日-bp分阶段</td>
                        <td>63</td>
                        <td class="red-text">9</td>
                        <td class="red-text">14.29%</td>
                    </tr>
                    <tr>
                        <td>8月节日-手札</td>
                        <td>44</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-单笔充值</td>
                        <td>42</td>
                        <td class="red-text">2</td>
                        <td class="red-text">4.76%</td>
                    </tr>
                    <tr>
                        <td>8月节日-行军皮肤套装</td>
                        <td>38</td>
                        <td class="red-text">2</td>
                        <td class="red-text">5.26%</td>
                    </tr>
                    <tr>
                        <td>8月节日-投票预热</td>
                        <td>36</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-1周年gacha返场</td>
                        <td>29</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-行军特效礼包</td>
                        <td>25</td>
                        <td class="red-text">1</td>
                        <td class="red-text">4.00%</td>
                    </tr>
                    <tr>
                        <td>幸运转盘联动活动</td>
                        <td>25</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-大富翁优化</td>
                        <td>23</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-组件gacha</td>
                        <td>21</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>军备超值BP</td>
                        <td>15</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-年报</td>
                        <td>12</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-庆典抽奖</td>
                        <td>10</td>
                        <td class="red-text">1</td>
                        <td class="red-text">10.00%</td>
                    </tr>
                    <tr>
                        <td>8月节日-装饰兑换</td>
                        <td>9</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                    <tr>
                        <td>金刚机甲皮肤</td>
                        <td>8</td>
                        <td class="red-text">1</td>
                        <td class="red-text">12.50%</td>
                    </tr>
                    <tr>
                        <td>合服</td>
                        <td>8</td>
                        <td>0</td>
                        <td>0.00%</td>
                    </tr>
                </tbody>
            </table>
            <div style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 15px;">Bug数量前5功能分布（按处理人部门）</h3>
                <div class="chart-container" style="height: 450px;">
                    <canvas id="featureChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 功能稳定周期&超期 -->
        <div class="card">
            <div class="card-title">功能稳定周期&超期</div>
            <p style="color: #718096; margin-bottom: 20px; font-size: 0.9em;">
                <strong>定义：</strong>指bug从开始创建到最后修复完成的持续时间（工作日天数）
            </p>
            <div class="flex-container">
                <div class="flex-item">
                    <h3 style="text-align: center; margin-bottom: 15px;">功能持续周期</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>功能名称</th>
                                <th>持续周期（天）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>8月节日-投票预热</td>
                                <td>19</td>
                            </tr>
                            <tr>
                                <td>8月节日-手札</td>
                                <td>16</td>
                            </tr>
                            <tr>
                                <td>巅峰战场优化</td>
                                <td>14</td>
                            </tr>
                            <tr>
                                <td>8月节日-bp分阶段</td>
                                <td>12</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="flex-item">
                    <h3 style="text-align: center; margin-bottom: 15px;">功能持续周期甘特图</h3>
                    <div class="gantt-container">
                        <canvas id="ganttChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 重点功能分析 -->
        <div class="card">
            <div class="card-title">重点功能分析</div>
            <h3 style="margin-bottom: 15px;">【8月节日-主体gacha】详细分析</h3>
            <div style="background: #f7fafc; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <p><strong>Bug总数：</strong>96个</p>
                <p><strong>占版本总Bug数：</strong>11.91%</p>
            </div>
            <h4 style="margin: 20px 0 10px 0;">按任务处理人统计</h4>
            <table>
                <thead>
                    <tr>
                        <th>任务处理人</th>
                        <th>Bug数量</th>
                        <th>占该功能比例</th>
                        <th>修复时长超2天数量</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>林康</td>
                        <td>27</td>
                        <td>28.12%</td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td>莫琪</td>
                        <td>26</td>
                        <td>27.08%</td>
                        <td>10</td>
                    </tr>
                    <tr>
                        <td>李嘉睿</td>
                        <td>20</td>
                        <td>20.83%</td>
                        <td>5</td>
                    </tr>
                    <tr>
                        <td>徐琮淦</td>
                        <td>12</td>
                        <td>12.50%</td>
                        <td>4</td>
                    </tr>
                    <tr>
                        <td>张婷</td>
                        <td>5</td>
                        <td>5.21%</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td>陈思</td>
                        <td>4</td>
                        <td>4.17%</td>
                        <td>4</td>
                    </tr>
                    <tr>
                        <td>何超</td>
                        <td>1</td>
                        <td>1.04%</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>李家竹</td>
                        <td>1</td>
                        <td>1.04%</td>
                        <td>1</td>
                    </tr>
                </tbody>
            </table>
            <div style="margin-top: 20px; padding: 15px; background: #fffaf0; border-left: 4px solid #ed8936; border-radius: 8px;">
                <p><strong>修复时长最长的Bug：</strong></p>
                <p>P2DEV-129840 - 【8月节日】【主体gacha】阶段奖励档位及奖励与需求不符</p>
                <p><strong>处理人：</strong>张婷</p>
                <p><strong>修复时长：</strong>20.12天</p>
            </div>
        </div>

        <!-- 节日活动问题分析 -->
        <div class="card">
            <div class="card-title">节日活动问题分析</div>
            <p style="margin-bottom: 15px;">节日功能Bug总数：<strong>547个</strong>，占版本总Bug数的 <strong>67.87%</strong></p>
            <table>
                <thead>
                    <tr>
                        <th>功能名称</th>
                        <th>Bug数量</th>
                        <th>平均修复时长（天）</th>
                        <th>主要处理人</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>8月节日-主体gacha</td>
                        <td>96</td>
                        <td>3.02</td>
                        <td>林康(27), 莫琪(26), 李嘉睿(20)</td>
                    </tr>
                    <tr>
                        <td>8月节日-装饰许愿</td>
                        <td>75</td>
                        <td>1.20</td>
                        <td>王姣(30), 李嘉睿(18), 莫琪(16)</td>
                    </tr>
                    <tr>
                        <td>8月节日-bp分阶段</td>
                        <td>63</td>
                        <td>1.53</td>
                        <td>孙明昊(39), 刘力珲(17), 莫琪(5)</td>
                    </tr>
                    <tr>
                        <td>8月节日-手札</td>
                        <td>44</td>
                        <td>1.96</td>
                        <td>莫琪(18), 龚亮(17), 何超(7)</td>
                    </tr>
                    <tr>
                        <td>8月节日-单笔充值</td>
                        <td>42</td>
                        <td>2.44</td>
                        <td>林康(13), 何超(10), 李钢(9)</td>
                    </tr>
                    <tr>
                        <td>8月节日-行军皮肤套装</td>
                        <td>38</td>
                        <td>4.03</td>
                        <td>何超(15), 孙明昊(14), 张豪杰(5)</td>
                    </tr>
                    <tr>
                        <td>8月节日-投票预热</td>
                        <td>36</td>
                        <td>1.77</td>
                        <td>刘力珲(14), 林康(8), 张涵(5)</td>
                    </tr>
                    <tr>
                        <td>8月节日-1周年gacha返场</td>
                        <td>29</td>
                        <td>1.33</td>
                        <td>林康(15), 何超(8), 张婷(3)</td>
                    </tr>
                    <tr>
                        <td>8月节日-行军特效礼包</td>
                        <td>25</td>
                        <td>1.85</td>
                        <td>孙明昊(17), 莫琪(4), 张治春(3)</td>
                    </tr>
                    <tr>
                        <td>8月节日-大富翁优化</td>
                        <td>23</td>
                        <td>1.79</td>
                        <td>刘德江(9), 方菱葭(5), 孙明昊(4)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 需求转Bug问题分析 -->
        <div class="card">
            <div class="card-title">需求转Bug问题分析</div>
            <p style="margin-bottom: 15px;">需求转Bug总数：<strong>14个</strong>，占版本总Bug数的 <strong>1.74%</strong>，平均修复时长：<strong>2.37天</strong></p>
            <table>
                <thead>
                    <tr>
                        <th>功能名称</th>
                        <th>数量</th>
                        <th>处理人</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>8月节日-行军皮肤套装</td>
                        <td>1</td>
                        <td>孙明昊</td>
                    </tr>
                    <tr>
                        <td>8月节日-装饰商店</td>
                        <td>1</td>
                        <td>林康</td>
                    </tr>
                    <tr>
                        <td>8月节日-幸运扭蛋机</td>
                        <td>1</td>
                        <td>何超</td>
                    </tr>
                    <tr>
                        <td>8月节日-年报</td>
                        <td>1</td>
                        <td>何超</td>
                    </tr>
                    <tr>
                        <td>8月节日-单笔充值</td>
                        <td>1</td>
                        <td>龚亮</td>
                    </tr>
                    <tr>
                        <td>8月节日-手札</td>
                        <td>1</td>
                        <td>莫琪</td>
                    </tr>
                    <tr>
                        <td>8月节日-投票预热</td>
                        <td>1</td>
                        <td>刘力珲</td>
                    </tr>
                    <tr>
                        <td>8月节日-行军特效礼包</td>
                        <td>1</td>
                        <td>张治春</td>
                    </tr>
                    <tr>
                        <td>8月节日-单笔充值_联盟累充</td>
                        <td>1</td>
                        <td>何超</td>
                    </tr>
                    <tr>
                        <td>kvk预热活动</td>
                        <td>2</td>
                        <td>何超, 莫琪</td>
                    </tr>
                    <tr>
                        <td>军备超值BP</td>
                        <td>1</td>
                        <td>莫琪</td>
                    </tr>
                    <tr>
                        <td>bi推荐加战装</td>
                        <td>1</td>
                        <td>张治春</td>
                    </tr>
                    <tr>
                        <td>幸运转盘联动活动</td>
                        <td>1</td>
                        <td>何超</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 版本分析与总结 -->
        <div class="card">
            <div class="card-title">版本分析与总结</div>
            
            <h3 style="margin-top: 20px;">📊 整体概况</h3>
            <p style="line-height: 1.8; color: #4a5568;">
                0.78.0版本于2025年6月30日至7月28日期间开发，历时<strong>29天</strong>。本版本以<strong>8月节日活动</strong>为核心，共产生<strong>806个Bug</strong>，日均<strong>27.8个</strong>。团队最终解决了<strong>760个Bug</strong>，解决率达到<strong>94.29%</strong>，平均修复时长为<strong>2.03天</strong>。
            </p>

            <h3 style="margin-top: 30px;">✅ 版本亮点</h3>
            <div style="background: #f0fff4; border-left: 4px solid #48bb78; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                    <li><strong>解决率优秀</strong>：94.29%的解决率表明团队对Bug的处理非常积极，问题响应及时</li>
                    <li><strong>修复速度快</strong>：平均2.03天的修复时长处于良好水平，团队执行效率高</li>
                    <li><strong>高优先级控制好</strong>：仅4.59%的高优先级Bug占比，说明版本质量基线较高</li>
                    <li><strong>需求转Bug少</strong>：1.74%的需求转Bug占比，反映需求评审质量较好</li>
                </ul>
            </div>

            <h3 style="margin-top: 30px;">⚠️ 存在问题</h3>
            <div style="background: #fff5f5; border-left: 4px solid #fc8181; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                    <li><strong>Bug总量偏多</strong>：日均27.8个Bug处于偏高水平，反映开发阶段质量控制有待加强</li>
                    <li><strong>Bug重开率偏高</strong>：13.52%的重开率（109个Bug被重新打开），说明部分Bug修复质量不够扎实，需要加强测试验证</li>
                    <li><strong>节日功能Bug集中</strong>：67.87%的Bug来自8月节日活动，虽然符合版本特性，但也暴露出节日功能的复杂度和测试难度</li>
                    <li><strong>部分功能周期长</strong>：8月节日-行军皮肤套装持续23个工作日，8月节日-主体gacha持续20个工作日，需要优化开发和测试流程</li>
                </ul>
            </div>

            <h3 style="margin-top: 30px;">🎯 重点功能分析</h3>
            <div style="background: #fffaf0; border-left: 4px solid #f59e0b; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <p style="margin: 0 0 10px 0; line-height: 1.8;"><strong>8月节日-主体gacha</strong>（96个Bug，占比11.91%）</p>
                <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                    <li>Bug数量最多，涉及运营策划、GUI、客户端、服务器多个部门</li>
                    <li>持续周期20个工作日，从7月11日到8月7日</li>
                    <li>主要问题集中在界面显示、功能逻辑、奖励配置等方面</li>
                    <li>建议：复杂gacha功能需提前介入测试，加强配置验证</li>
                </ul>
            </div>

            <h3 style="margin-top: 30px;">💡 改进建议</h3>
            <div style="background: #ebf8ff; border-left: 4px solid #4299e1; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <ol style="margin: 0; padding-left: 20px; line-height: 2;">
                    <li><strong>优化开发流程</strong>：加强需求评审和技术方案设计，减少开发阶段的返工</li>
                    <li><strong>提升修复质量</strong>：建立Bug修复验证机制，降低重开率，避免反复修改</li>
                    <li><strong>强化进度管理</strong>：对重点功能设置里程碑节点，及时识别和解决延期风险</li>
                    <li><strong>完善测试策略</strong>：针对节日活动等复杂功能，提前制定专项测试方案</li>
                    <li><strong>加强质量意识</strong>：在开发阶段就注重代码质量，减少Bug产生</li>
                </ol>
            </div>
        </div>

        <!-- 版本质量评分 -->
        <div class="card">
            <div class="card-title">版本质量评分</div>
            <p style="color: #718096; margin-bottom: 20px; font-size: 0.9em;">
                <strong>评分依据：</strong>基于《版本质量评分标准v1.0》，从5个维度进行综合评估
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 30px 0;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <div style="font-size: 3em; font-weight: bold; margin-bottom: 10px;">73</div>
                    <div style="font-size: 1.2em; opacity: 0.9;">综合评分</div>
                    <div style="font-size: 1.5em; font-weight: bold; margin-top: 10px;">中等</div>
                </div>
            </div>

            <h3 style="margin-top: 30px;">评分明细</h3>
            <table style="margin-top: 15px;">
                <thead>
                    <tr>
                        <th>评分维度</th>
                        <th>得分</th>
                        <th>权重</th>
                        <th>贡献</th>
                        <th>评级</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>版本周期达成度</td>
                        <td>75分</td>
                        <td>25%</td>
                        <td>18.75分</td>
                        <td><span class="badge badge-good">中等偏上</span></td>
                    </tr>
                    <tr>
                        <td>Bug总量控制</td>
                        <td>65分</td>
                        <td>20%</td>
                        <td>13.00分</td>
                        <td><span class="badge badge-medium">需改进</span></td>
                    </tr>
                    <tr>
                        <td>解决率与修复速度</td>
                        <td>82分</td>
                        <td>20%</td>
                        <td>16.40分</td>
                        <td><span class="badge badge-good">良好</span></td>
                    </tr>
                    <tr>
                        <td>修复质量</td>
                        <td>73分</td>
                        <td>20%</td>
                        <td>14.60分</td>
                        <td><span class="badge badge-medium">中等</span></td>
                    </tr>
                    <tr>
                        <td>特殊问题控制</td>
                        <td>65分</td>
                        <td>15%</td>
                        <td>9.75分</td>
                        <td><span class="badge badge-medium">需改进</span></td>
                    </tr>
                    <tr style="background: #f7fafc; font-weight: bold;">
                        <td>综合评分</td>
                        <td colspan="2">73分</td>
                        <td>72.50分</td>
                        <td><span class="badge badge-medium">中等</span></td>
                    </tr>
                </tbody>
            </table>

            <h3 style="margin-top: 30px;">评分说明</h3>
            <div style="line-height: 2; color: #4a5568;">
                <p><strong>1. 版本周期达成度（75分）</strong></p>
                <p style="margin-left: 20px;">版本周期29天，Top4功能平均超期5.25天，其中投票预热超期19天，手札超期16天，整体进度控制有待提升。</p>

                <p style="margin-top: 15px;"><strong>2. Bug总量控制（65分）</strong></p>
                <p style="margin-left: 20px;">日均27.8个Bug处于中等偏高水平，主要由于8月节日活动功能复杂度高，Bug总量达547个，占比67.87%。</p>

                <p style="margin-top: 15px;"><strong>3. 解决率与修复速度（82分）</strong></p>
                <p style="margin-left: 20px;">解决率94.29%表现良好，平均修复时长2.03天处于合理水平，团队响应及时。</p>

                <p style="margin-top: 15px;"><strong>4. 修复质量（73分）</strong></p>
                <p style="margin-left: 20px;">13.52%的重开率处于中等水平，相比上版本有所改善，但仍需加强修复验证和回归测试。</p>

                <p style="margin-top: 15px;"><strong>5. 特殊问题控制（65分）</strong></p>
                <p style="margin-left: 20px;">高优先级Bug占比4.59%、需求转Bug占比1.74%均表现良好。节日Bug占比67.87%较高，主要集中在8月节日活动的主体gacha、装饰许愿、bp分阶段等核心功能。</p>
            </div>

            <h3 style="margin-top: 30px;">总体评价</h3>
            <div style="background: #f7fafc; border-left: 4px solid #667eea; padding: 20px; border-radius: 8px; margin: 15px 0;">
                <p style="line-height: 2; margin: 0; color: #2d3748;">
                    0.78.0版本综合评分<strong>73分</strong>，评级为<strong>中等</strong>。团队在Bug响应和修复速度方面表现良好，解决率达94.29%，平均修复时长2.03天。主要挑战来自8月节日活动的高复杂度，导致Bug总量较高（547个，占比67.87%），重开率13.52%处于中等水平。建议后续版本在复杂功能开发时加强前期设计评审和测试覆盖，提升整体交付质量。
                </p>
            </div>
        </div>
    </div>

    <script>
        // 解决结果分布饼图
        const resultCtx = document.getElementById('resultChart').getContext('2d');
        new Chart(resultCtx, {
            type: 'pie',
            data: {
                labels: ['已解决', '不能复现', '非缺陷', '不解决', '重复提交'],
                datasets: [{
                    data: [760, 18, 17, 10, 1],
                    backgroundColor: [
                        '#48bb78',
                        '#90cdf4',
                        '#cbd5e0',
                        '#f6ad55',
                        '#d6bcfa'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            font: {
                                size: 14
                            },
                            padding: 15
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.parsed || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = ((value / total) * 100).toFixed(2);
                                return label + ': ' + value + ' (' + percentage + '%)';
                            }
                        }
                    },
                    datalabels: {
                        display: false
                    }
                }
            }
        });

        // 四象限散点图
        const scatterCtx = document.getElementById('scatterChart').getContext('2d');
        
        // 计算中位数作为象限分界线
        const bugCounts = [117, 78, 72, 71, 54, 53, 41, 37, 37, 36, 31, 28, 12, 12, 10, 9, 5, 5];
        const reopenRates = [6.84, 15.38, 12.50, 18.31, 20.37, 7.55, 7.32, 24.32, 13.51, 13.89, 12.90, 21.43, 25.00, 16.67, 20.00, 22.22, 40.00, 20.00];
        const medianBugCount = 36.5; // 中位数
        const medianReopenRate = 17.49; // 中位数
        
        // 四象限背景插件
        const quadrantPlugin = {
            id: 'quadrantPlugin',
            beforeDraw: (chart) => {
                const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
                const xMid = x.getPixelForValue(medianBugCount);
                const yMid = y.getPixelForValue(medianReopenRate);
                
                ctx.save();
                
                // 第一象限（右上）- 高Bug数量，高重开率 - 红色
                ctx.fillStyle = 'rgba(254, 178, 178, 0.15)';
                ctx.fillRect(xMid, top, right - xMid, yMid - top);
                
                // 第二象限（左上）- 低Bug数量，高重开率 - 橙色
                ctx.fillStyle = 'rgba(251, 211, 141, 0.15)';
                ctx.fillRect(left, top, xMid - left, yMid - top);
                
                // 第三象限（左下）- 低Bug数量，低重开率 - 绿色
                ctx.fillStyle = 'rgba(154, 230, 180, 0.15)';
                ctx.fillRect(left, yMid, xMid - left, bottom - yMid);
                
                // 第四象限（右下）- 高Bug数量，低重开率 - 黄色
                ctx.fillStyle = 'rgba(250, 240, 137, 0.15)';
                ctx.fillRect(xMid, yMid, right - xMid, bottom - yMid);
                
                // 绘制分界线
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                
                // 垂直线
                ctx.beginPath();
                ctx.moveTo(xMid, top);
                ctx.lineTo(xMid, bottom);
                ctx.stroke();
                
                // 水平线
                ctx.beginPath();
                ctx.moveTo(left, yMid);
                ctx.lineTo(right, yMid);
                ctx.stroke();
                
                ctx.restore();
            }
        };
        
        // 标签插件 - 在圆点旁边显示名字（带碰撞检测）
        const labelPlugin = {
            id: 'labelPlugin',
            afterDatasetsDraw: (chart) => {
                const {ctx, chartArea: {left, top, right, bottom}} = chart;
                const labelPositions = []; // 存储已绘制的标签位置
                
                // 检查两个矩形是否重叠
                const isOverlapping = (rect1, rect2) => {
                    return !(rect1.right < rect2.left || 
                            rect1.left > rect2.right || 
                            rect1.bottom < rect2.top || 
                            rect1.top > rect2.bottom);
                };
                
                chart.data.datasets.forEach((dataset, i) => {
                    const meta = chart.getDatasetMeta(i);
                    if (!meta.hidden) {
                        meta.data.forEach((element, index) => {
                            const {x, y} = element.tooltipPosition();
                            
                            ctx.save();
                            ctx.font = 'bold 12px Arial';
                            ctx.fillStyle = '#2d3748';
                            
                            const textWidth = ctx.measureText(dataset.label).width;
                            const textHeight = 14;
                            const padding = 2;
                            
                            // 尝试不同的位置：右、左、上、下、右上、右下、左上、左下
                            const positions = [
                                {x: x + 12, y: y, align: 'left', baseline: 'middle'},
                                {x: x - 12, y: y, align: 'right', baseline: 'middle'},
                                {x: x, y: y - 15, align: 'center', baseline: 'bottom'},
                                {x: x, y: y + 15, align: 'center', baseline: 'top'},
                                {x: x + 12, y: y - 10, align: 'left', baseline: 'bottom'},
                                {x: x + 12, y: y + 10, align: 'left', baseline: 'top'},
                                {x: x - 12, y: y - 10, align: 'right', baseline: 'bottom'},
                                {x: x - 12, y: y + 10, align: 'right', baseline: 'top'}
                            ];
                            
                            let bestPosition = positions[0];
                            let foundPosition = false;
                            
                            // 尝试每个位置，找到第一个不重叠的
                            for (const pos of positions) {
                                let labelLeft, labelRight, labelTop, labelBottom;
                                
                                if (pos.align === 'left') {
                                    labelLeft = pos.x;
                                    labelRight = pos.x + textWidth;
                                } else if (pos.align === 'right') {
                                    labelLeft = pos.x - textWidth;
                                    labelRight = pos.x;
                                } else {
                                    labelLeft = pos.x - textWidth / 2;
                                    labelRight = pos.x + textWidth / 2;
                                }
                                
                                if (pos.baseline === 'middle') {
                                    labelTop = pos.y - textHeight / 2;
                                    labelBottom = pos.y + textHeight / 2;
                                } else if (pos.baseline === 'top') {
                                    labelTop = pos.y;
                                    labelBottom = pos.y + textHeight;
                                } else {
                                    labelTop = pos.y - textHeight;
                                    labelBottom = pos.y;
                                }
                                
                                const labelRect = {
                                    left: labelLeft - padding,
                                    right: labelRight + padding,
                                    top: labelTop - padding,
                                    bottom: labelBottom + padding
                                };
                                
                                // 检查是否在图表范围内
                                if (labelRect.left < left || labelRect.right > right || 
                                    labelRect.top < top || labelRect.bottom > bottom) {
                                    continue;
                                }
                                
                                // 检查是否与已有标签重叠
                                let hasOverlap = false;
                                for (const existingRect of labelPositions) {
                                    if (isOverlapping(labelRect, existingRect)) {
                                        hasOverlap = true;
                                        break;
                                    }
                                }
                                
                                if (!hasOverlap) {
                                    bestPosition = pos;
                                    labelPositions.push(labelRect);
                                    foundPosition = true;
                                    break;
                                }
                            }
                            
                            // 如果所有位置都重叠，使用第一个位置并记录
                            if (!foundPosition) {
                                const pos = positions[0];
                                let labelLeft = pos.x;
                                let labelRight = pos.x + textWidth;
                                let labelTop = pos.y - textHeight / 2;
                                let labelBottom = pos.y + textHeight / 2;
                                
                                labelPositions.push({
                                    left: labelLeft - padding,
                                    right: labelRight + padding,
                                    top: labelTop - padding,
                                    bottom: labelBottom + padding
                                });
                            }
                            
                            ctx.textAlign = bestPosition.align;
                            ctx.textBaseline = bestPosition.baseline;
                            ctx.fillText(dataset.label, bestPosition.x, bestPosition.y);
                            
                            ctx.restore();
                        });
                    }
                });
            }
        };
        
        new Chart(scatterCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: '莫琪',
                    data: [{x: 117, y: 6.84}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '孙明昊',
                    data: [{x: 78, y: 15.38}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '林康',
                    data: [{x: 72, y: 12.50}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '何超',
                    data: [{x: 71, y: 18.31}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '李钢',
                    data: [{x: 54, y: 20.37}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '龚亮',
                    data: [{x: 53, y: 7.55}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '李嘉睿',
                    data: [{x: 41, y: 7.32}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '徐琮淦',
                    data: [{x: 37, y: 24.32}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王姣',
                    data: [{x: 37, y: 13.51}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '刘力珲',
                    data: [{x: 36, y: 13.89}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '张涵',
                    data: [{x: 31, y: 12.90}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '张婷',
                    data: [{x: 28, y: 21.43}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '谭畅',
                    data: [{x: 12, y: 25.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王然',
                    data: [{x: 12, y: 16.67}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王子琛',
                    data: [{x: 10, y: 20.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '方菱葭',
                    data: [{x: 9, y: 22.22}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '田明月',
                    data: [{x: 5, y: 40.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '刘思毅',
                    data: [{x: 5, y: 20.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Bug数量',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        min: 0,
                        max: 125
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Bug重开率 (%)',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        min: 0,
                        max: 55
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': Bug数=' + context.parsed.x + ', 重开率=' + context.parsed.y.toFixed(2) + '%';
                            }
                        }
                    },
                    datalabels: {
                        display: false
                    }
                }
            },
            plugins: [quadrantPlugin, labelPlugin]
        });

        // 修复效率 vs 重开率 四象限图
        const efficiencyScatterCtx = document.getElementById('efficiencyScatterChart').getContext('2d');
        
        // 计算中位数作为象限分界线
        const avgFixTimes = [4.71, 3.10, 2.90, 2.60, 2.29, 2.20, 1.80, 1.73, 1.70, 1.61, 1.49, 1.45, 1.34, 1.26, 1.11, 1.06, 0.85, 0.80];
        const reopenRates2 = [21.43, 7.55, 15.38, 12.50, 24.32, 25.00, 12.90, 13.51, 16.67, 22.22, 6.84, 13.89, 18.31, 20.37, 20.00, 20.00, 7.32, 40.00];
        const medianFixTime = 1.66; // 中位数
        const medianReopenRate2 = 17.49; // 中位数
        
        // 四象限背景插件
        const quadrantPlugin2 = {
            id: 'quadrantPlugin2',
            beforeDraw: (chart) => {
                const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
                const xMid = x.getPixelForValue(medianFixTime);
                const yMid = y.getPixelForValue(medianReopenRate2);
                
                ctx.save();
                
                // 第一象限（右上）- 慢修复，高重开率 - 红色（最差）
                ctx.fillStyle = 'rgba(254, 178, 178, 0.15)';
                ctx.fillRect(xMid, top, right - xMid, yMid - top);
                
                // 第二象限（左上）- 快修复，高重开率 - 橙色（质量需改进）
                ctx.fillStyle = 'rgba(251, 211, 141, 0.15)';
                ctx.fillRect(left, top, xMid - left, yMid - top);
                
                // 第三象限（左下）- 快修复，低重开率 - 绿色（最优）
                ctx.fillStyle = 'rgba(154, 230, 180, 0.15)';
                ctx.fillRect(left, yMid, xMid - left, bottom - yMid);
                
                // 第四象限（右下）- 慢修复，低重开率 - 黄色（效率需改进）
                ctx.fillStyle = 'rgba(250, 240, 137, 0.15)';
                ctx.fillRect(xMid, yMid, right - xMid, bottom - yMid);
                
                // 绘制分界线
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                
                // 垂直线
                ctx.beginPath();
                ctx.moveTo(xMid, top);
                ctx.lineTo(xMid, bottom);
                ctx.stroke();
                
                // 水平线
                ctx.beginPath();
                ctx.moveTo(left, yMid);
                ctx.lineTo(right, yMid);
                ctx.stroke();
                
                ctx.restore();
            }
        };
        
        // 标签插件（带碰撞检测）
        const labelPlugin2 = {
            id: 'labelPlugin2',
            afterDatasetsDraw: (chart) => {
                const {ctx, chartArea: {left, top, right, bottom}} = chart;
                const labelPositions = []; // 存储已绘制的标签位置
                
                // 检查两个矩形是否重叠
                const isOverlapping = (rect1, rect2) => {
                    return !(rect1.right < rect2.left || 
                            rect1.left > rect2.right || 
                            rect1.bottom < rect2.top || 
                            rect1.top > rect2.bottom);
                };
                
                chart.data.datasets.forEach((dataset, i) => {
                    const meta = chart.getDatasetMeta(i);
                    if (!meta.hidden) {
                        meta.data.forEach((element, index) => {
                            const {x, y} = element.tooltipPosition();
                            
                            ctx.save();
                            ctx.font = 'bold 12px Arial';
                            ctx.fillStyle = '#2d3748';
                            
                            const textWidth = ctx.measureText(dataset.label).width;
                            const textHeight = 14;
                            const padding = 2;
                            
                            // 尝试不同的位置：右、左、上、下、右上、右下、左上、左下
                            const positions = [
                                {x: x + 12, y: y, align: 'left', baseline: 'middle'},
                                {x: x - 12, y: y, align: 'right', baseline: 'middle'},
                                {x: x, y: y - 15, align: 'center', baseline: 'bottom'},
                                {x: x, y: y + 15, align: 'center', baseline: 'top'},
                                {x: x + 12, y: y - 10, align: 'left', baseline: 'bottom'},
                                {x: x + 12, y: y + 10, align: 'left', baseline: 'top'},
                                {x: x - 12, y: y - 10, align: 'right', baseline: 'bottom'},
                                {x: x - 12, y: y + 10, align: 'right', baseline: 'top'}
                            ];
                            
                            let bestPosition = positions[0];
                            let foundPosition = false;
                            
                            // 尝试每个位置，找到第一个不重叠的
                            for (const pos of positions) {
                                let labelLeft, labelRight, labelTop, labelBottom;
                                
                                if (pos.align === 'left') {
                                    labelLeft = pos.x;
                                    labelRight = pos.x + textWidth;
                                } else if (pos.align === 'right') {
                                    labelLeft = pos.x - textWidth;
                                    labelRight = pos.x;
                                } else {
                                    labelLeft = pos.x - textWidth / 2;
                                    labelRight = pos.x + textWidth / 2;
                                }
                                
                                if (pos.baseline === 'middle') {
                                    labelTop = pos.y - textHeight / 2;
                                    labelBottom = pos.y + textHeight / 2;
                                } else if (pos.baseline === 'top') {
                                    labelTop = pos.y;
                                    labelBottom = pos.y + textHeight;
                                } else {
                                    labelTop = pos.y - textHeight;
                                    labelBottom = pos.y;
                                }
                                
                                const labelRect = {
                                    left: labelLeft - padding,
                                    right: labelRight + padding,
                                    top: labelTop - padding,
                                    bottom: labelBottom + padding
                                };
                                
                                // 检查是否在图表范围内
                                if (labelRect.left < left || labelRect.right > right || 
                                    labelRect.top < top || labelRect.bottom > bottom) {
                                    continue;
                                }
                                
                                // 检查是否与已有标签重叠
                                let hasOverlap = false;
                                for (const existingRect of labelPositions) {
                                    if (isOverlapping(labelRect, existingRect)) {
                                        hasOverlap = true;
                                        break;
                                    }
                                }
                                
                                if (!hasOverlap) {
                                    bestPosition = pos;
                                    labelPositions.push(labelRect);
                                    foundPosition = true;
                                    break;
                                }
                            }
                            
                            // 如果所有位置都重叠，使用第一个位置并记录
                            if (!foundPosition) {
                                const pos = positions[0];
                                let labelLeft = pos.x;
                                let labelRight = pos.x + textWidth;
                                let labelTop = pos.y - textHeight / 2;
                                let labelBottom = pos.y + textHeight / 2;
                                
                                labelPositions.push({
                                    left: labelLeft - padding,
                                    right: labelRight + padding,
                                    top: labelTop - padding,
                                    bottom: labelBottom + padding
                                });
                            }
                            
                            ctx.textAlign = bestPosition.align;
                            ctx.textBaseline = bestPosition.baseline;
                            ctx.fillText(dataset.label, bestPosition.x, bestPosition.y);
                            
                            ctx.restore();
                        });
                    }
                });
            }
        };
        
        new Chart(efficiencyScatterCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: '张婷',
                    data: [{x: 4.71, y: 21.43}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '龚亮',
                    data: [{x: 3.10, y: 7.55}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '孙明昊',
                    data: [{x: 2.90, y: 15.38}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '林康',
                    data: [{x: 2.60, y: 12.50}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '徐琮淦',
                    data: [{x: 2.29, y: 24.32}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '谭畅',
                    data: [{x: 2.20, y: 25.00}],
                    backgroundColor: '#ef4444',
                    borderColor: '#dc2626',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '张涵',
                    data: [{x: 1.80, y: 12.90}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王姣',
                    data: [{x: 1.73, y: 13.51}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王然',
                    data: [{x: 1.70, y: 16.67}],
                    backgroundColor: '#eab308',
                    borderColor: '#ca8a04',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '方菱葭',
                    data: [{x: 1.61, y: 22.22}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '莫琪',
                    data: [{x: 1.49, y: 6.84}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '刘力珲',
                    data: [{x: 1.45, y: 13.89}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '何超',
                    data: [{x: 1.34, y: 18.31}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '李钢',
                    data: [{x: 1.26, y: 20.37}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '刘思毅',
                    data: [{x: 1.11, y: 20.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '王子琛',
                    data: [{x: 1.06, y: 20.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '李嘉睿',
                    data: [{x: 0.85, y: 7.32}],
                    backgroundColor: '#22c55e',
                    borderColor: '#16a34a',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }, {
                    label: '田明月',
                    data: [{x: 0.80, y: 40.00}],
                    backgroundColor: '#f97316',
                    borderColor: '#ea580c',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: '平均修复时长（天）',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        min: 0,
                        max: 5.0,
                        reverse: false
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Bug重开率 (%)',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        min: 0,
                        max: 55
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': 修复时长=' + context.parsed.x.toFixed(2) + '天, 重开率=' + context.parsed.y.toFixed(2) + '%';
                            }
                        }
                    },
                    datalabels: {
                        display: false
                    }
                }
            },
            plugins: [quadrantPlugin2, labelPlugin2]
        });

        // 功能Bug分布柱状图（按处理人部门堆叠）
        const featureCtx = document.getElementById('featureChart').getContext('2d');
        
        // 自定义插件：在柱顶显示总数
        const topLabelsPlugin = {
            id: 'topLabelsPlugin',
            afterDatasetsDraw(chart) {
                const { ctx, chartArea: { top }, scales: { x, y } } = chart;
                
                chart.data.labels.forEach((label, index) => {
                    // 计算每个柱子的总数
                    const total = chart.data.datasets.reduce((sum, dataset) => {
                        return sum + (dataset.data[index] || 0);
                    }, 0);
                    
                    // 获取柱子顶部的Y坐标
                    const xPos = x.getPixelForValue(index);
                    const yPos = y.getPixelForValue(total);
                    
                    ctx.save();
                    ctx.font = 'bold 14px Arial';
                    ctx.fillStyle = '#2d3748';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    ctx.fillText(total, xPos, yPos - 5);
                    ctx.restore();
                });
            }
        };
        
        // 自定义插件：在柱形内显示百分比
        const percentagePlugin = {
            id: 'percentagePlugin',
            afterDatasetsDraw(chart) {
                const { ctx } = chart;
                
                chart.data.datasets.forEach((dataset, datasetIndex) => {
                    const meta = chart.getDatasetMeta(datasetIndex);
                    
                    meta.data.forEach((bar, index) => {
                        const value = dataset.data[index];
                        if (!value || value === 0) return;
                        
                        // 计算总数
                        const total = chart.data.datasets.reduce((sum, ds) => {
                            return sum + (ds.data[index] || 0);
                        }, 0);
                        
                        const percentage = ((value / total) * 100).toFixed(1);
                        
                        // 获取色块的高度
                        const barHeight = Math.abs(bar.y - bar.base);
                        
                        // 只有当色块高度大于25像素时才显示百分比
                        if (barHeight < 25) return;
                        
                        // 计算色块中心位置
                        const xPos = bar.x;
                        const yPos = (bar.y + bar.base) / 2;
                        
                        ctx.save();
                        ctx.font = 'bold 12px Arial';
                        ctx.fillStyle = '#ffffff';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        
                        // 添加文字阴影以提高可读性
                        ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                        ctx.shadowBlur = 3;
                        ctx.shadowOffsetX = 0;
                        ctx.shadowOffsetY = 1;
                        
                        ctx.fillText(percentage + '%', xPos, yPos);
                        ctx.restore();
                    });
                });
            }
        };
        
        new Chart(featureCtx, {
            type: 'bar',
            data: {
                labels: ['8月节日-主体gacha', '新跨服战场优化', '巅峰战场优化', '8月节日-装饰许愿', '8月节日-bp分阶段'],
                datasets: [
                    {
                        label: '运营策划',
                        data: [32, 12, 22, 31, 39],
                        backgroundColor: '#8b5cf6'  // 紫色
                    },
                    {
                        label: '客户端',
                        data: [21, 21, 20, 18, 17],
                        backgroundColor: '#3b82f6'  // 蓝色
                    },
                    {
                        label: '服务器',
                        data: [12, 40, 24, 10, 0],
                        backgroundColor: '#10b981'  // 绿色
                    },
                    {
                        label: 'GUI',
                        data: [26, 10, 10, 16, 5],
                        backgroundColor: '#f59e0b'  // 橙色
                    },
                    {
                        label: '美术',
                        data: [4, 1, 0, 0, 2],
                        backgroundColor: '#ef4444'  // 红色
                    },
                    {
                        label: 'QA',
                        data: [1, 0, 0, 0, 0],
                        backgroundColor: '#ec4899'  // 粉色
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true,
                        ticks: {
                            font: {
                                size: 11
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Bug数量',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                size: 12
                            },
                            padding: 10,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.dataset.label || '';
                                const value = context.parsed.y || 0;
                                const total = context.chart.data.datasets.reduce((sum, dataset) => {
                                    return sum + (dataset.data[context.dataIndex] || 0);
                                }, 0);
                                const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                return label + ': ' + value + ' (' + percentage + '%)';
                            },
                            afterLabel: function(context) {
                                const total = context.chart.data.datasets.reduce((sum, dataset) => {
                                    return sum + (dataset.data[context.dataIndex] || 0);
                                }, 0);
                                if (context.datasetIndex === context.chart.data.datasets.length - 1) {
                                    return '总计: ' + total;
                                }
                                return '';
                            }
                        }
                    },
                    datalabels: {
                        display: false
                    }
                }
            },
            plugins: [topLabelsPlugin, percentagePlugin]
        });

        // 甘特图（基于日期的时间轴）
        const ganttCtx = document.getElementById('ganttChart').getContext('2d');
        
        // 功能数据：[开始日期, 结束日期]
        const ganttData = [
            {
                name: '8月节日-投票预热',
                start: new Date('2025-07-14'),
                end: new Date('2025-08-07'),
                color: 'rgba(230, 126, 34, 0.7)',
                borderColor: 'rgb(230, 126, 34)'
            },
            {
                name: '8月节日-手札',
                start: new Date('2025-07-31'),
                end: new Date('2025-08-21'),
                color: 'rgba(52, 152, 219, 0.7)',
                borderColor: 'rgb(52, 152, 219)'
            },
            {
                name: '巅峰战场优化',
                start: new Date('2025-07-30'),
                end: new Date('2025-08-19'),
                color: 'rgba(46, 204, 113, 0.7)',
                borderColor: 'rgb(46, 204, 113)'
            },
            {
                name: '8月节日-bp分阶段',
                start: new Date('2025-07-25'),
                end: new Date('2025-08-11'),
                color: 'rgba(155, 89, 182, 0.7)',
                borderColor: 'rgb(155, 89, 182)'
            }
        ];
        
        // 版本部署日期
        const deployDate = new Date('2025-07-28');
        
        // 自定义插件：在条形内显示功能名称
        const ganttLabelPlugin = {
            id: 'ganttLabelPlugin',
            afterDatasetsDraw(chart) {
                const ctx = chart.ctx;
                chart.data.datasets[0].data.forEach((value, index) => {
                    const meta = chart.getDatasetMeta(0);
                    const bar = meta.data[index];
                    
                    ctx.save();
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 13px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    // 添加文字阴影以提高可读性
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                    ctx.shadowBlur = 3;
                    ctx.shadowOffsetX = 1;
                    ctx.shadowOffsetY = 1;
                    
                    const text = ganttData[index].name;
                    const x = (bar.x + bar.base) / 2; // 条形中心
                    const y = bar.y;
                    
                    ctx.fillText(text, x, y);
                    ctx.restore();
                });
            }
        };
        
        // 自定义插件：绘制版本部署日期标记线
        const deployLinePlugin = {
            id: 'deployLinePlugin',
            afterDatasetsDraw(chart) {
                const ctx = chart.ctx;
                const xScale = chart.scales.x;
                const yScale = chart.scales.y;
                
                const x = xScale.getPixelForValue(deployDate.getTime());
                const yTop = yScale.top;
                const yBottom = yScale.bottom;
                
                ctx.save();
                
                // 绘制红色实线
                ctx.strokeStyle = '#ef4444';
                ctx.lineWidth = 3;
                ctx.setLineDash([]);
                
                ctx.beginPath();
                ctx.moveTo(x, yTop);
                ctx.lineTo(x, yBottom);
                ctx.stroke();
                
                // 绘制顶部标记框
                const labelText = '版本部署';
                const dateText = '7.28';
                ctx.font = 'bold 11px Arial';
                const labelWidth = Math.max(ctx.measureText(labelText).width, ctx.measureText(dateText).width) + 16;
                const labelHeight = 36;
                const labelX = x - labelWidth / 2;
                const labelY = yTop - labelHeight - 5;
                
                // 绘制背景框
                ctx.fillStyle = '#ef4444';
                ctx.beginPath();
                ctx.roundRect(labelX, labelY, labelWidth, labelHeight, 4);
                ctx.fill();
                
                // 绘制文字
                ctx.fillStyle = '#ffffff';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(labelText, x, labelY + 11);
                ctx.font = 'bold 13px Arial';
                ctx.fillText(dateText, x, labelY + 25);
                
                ctx.restore();
            }
        };
        
        new Chart(ganttCtx, {
            type: 'bar',
            data: {
                labels: ganttData.map(d => d.name),
                datasets: [{
                    label: '功能周期',
                    data: ganttData.map(d => [d.start.getTime(), d.end.getTime()]),
                    backgroundColor: ganttData.map(d => d.color),
                    borderColor: ganttData.map(d => d.borderColor),
                    borderWidth: 2,
                    borderSkipped: false
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                layout: {
                    padding: {
                        top: 50  // 为顶部标记留出空间
                    }
                },
                scales: {
                    x: {
                        type: 'time',
                        time: {
                            unit: 'day',
                            displayFormats: {
                                day: 'MM-dd'
                            },
                            tooltipFormat: 'yyyy-MM-dd'
                        },
                        min: new Date('2025-07-05').getTime(),
                        max: new Date('2025-08-25').getTime(),
                        title: {
                            display: true,
                            text: '日期',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    },
                    y: {
                        ticks: {
                            display: false
                        },
                        grid: {
                            display: false
                        },
                        barPercentage: 0.5,  // 减小条形高度
                        categoryPercentage: 0.6
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const index = context.dataIndex;
                                const start = ganttData[index].start;
                                const end = ganttData[index].end;
                                const startStr = start.toLocaleDateString('zh-CN');
                                const endStr = end.toLocaleDateString('zh-CN');
                                const workdays = [19, 16, 14, 12][index]; // 对应4个功能的工作日
                                return [
                                    ganttData[index].name,
                                    '开始: ' + startStr,
                                    '结束: ' + endStr,
                                    '工作日: ' + workdays + '天'
                                ];
                            }
                        }
                    },
                    datalabels: {
                        display: false
                    }
                }
            },
            plugins: [ganttLabelPlugin, deployLinePlugin]
        });
    </script>
</body>
</html>
